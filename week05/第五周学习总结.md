## 1.css computing
**环境准备 **
$ `npm install css`
css就是一个css parser包，将css解析成一个AST(抽象语法树)

**css computing的过程**
根据抽象语法树抽出各种CSS规则，将css规则应用到HTML元素上。

#### 1.1 步骤一: 收集CSS规则
* `遇到style标签时，就把css规则保存起来`
* `可以直接使用CSS Parser来分析CSS规则;`

#### 1.2 步骤二: 添加调用
* `当创建元素之后，立即计算CSS`
* `当分析一个元素时，所有的CSS规则已收集完毕`
* `在真实浏览器中，可能遇到写在body的style标签，需要重新css计算的情况，可忽略；`

#### 1.3 步骤三：获取父元素序列
* `在computeCSS函数中，必须知道元素的所有父元素才能判断元素与规则是否匹配`
* `从之前步骤的stack中，可以获取本元素的所有的父元素`
* `首先获取的是当前元素，所以获得和计算父元素匹配的顺序是从内到外`

#### 1.4 步骤四：选择器与元素的匹配
* `选择器也要从当前元素向外排列`
* `复杂选择器拆成真对单个元素的选择器，用循环匹配副元素队列`

#### 1.5 步骤五：计算选择器与元素匹配
* `根据选择器的类型和元素属性，计算是否与当前元素匹配`


#### 1.6 步骤六：生成computed属性
* `一旦选择匹配，就应用选择器到元素上，形成computedStyle`


#### 1.7 步骤七：specificity的计算逻辑
* `CSS规则是根据specificity和后来优先规则覆盖css属性的`
* `specificity是个四元组，越左边权重越高`
* `一个css规则的specificity根据吧 Phan的简单选择器相加而成`



## 2.layout
#### 2.1 根据浏览器属性进行排版
排版：
* 主轴
* 交叉轴
#### 2.2 收集元素进行
**分行**
* 根据主轴尺寸，把元素分进行
* 若设置了no-wrap。则强行分配进第一行